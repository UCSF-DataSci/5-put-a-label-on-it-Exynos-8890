[![Review Assignment Due Date](https://classroom.github.com/assets/deadline-readme-button-22041afd0340ce965d47ae6ef1cefeee28c7c493a6346c4f15d667ab976d596c.svg)](https://classroom.github.com/a/i99LRj_R) [![Open in Codespaces](https://classroom.github.com/assets/launch-codespace-2972f46106e565e64193e422d61a12cf1da4916b45550586e14ef0a7c637dd04.svg)](https://classroom.github.com/open-in-codespaces?assignment_repo_id=19408700)

# Assignment 5: Health Data Classification

# 作业5：健康数据分类

## Objectives

## 目标

This assignment focuses on applying classification techniques to synthetic health data. You will practice:\
本次作业重点是将分类技术应用于合成健康数据。你将练习：

1.  **Data Loading and Preparation:** Handling basic data loading and preparing data for modeling.\
    **数据加载与准备：** 处理基本的数据加载并为建模做准备。
2.  **Binary Classification:** Implementing and evaluating a simple classification model (Logistic Regression).\
    **二元分类：** 实现并评估一个简单的分类模型（逻辑回归）。
3.  **Model Evaluation:** Calculating and interpreting key classification metrics.\
    **模型评估：** 计算并解释关键的分类指标。
4.  **Feature Engineering:** Extracting basic time-series features for classification.\
    **特征工程：** 提取用于分类的基本时间序列特征。
5.  **Tree-Based Models:** Implementing and comparing Random Forest and XGBoost classifiers.\
    **基于树的模型：** 实现并比较随机森林和XGBoost分类器。
6.  **Handling Categorical Data:** Using One-Hot Encoding.\
    **处理类别数据：** 使用独热编码（One-Hot Encoding）。
7.  **Handling Imbalanced Data:** Applying the SMOTE technique to address class imbalance.\
    **处理不平衡数据：** 应用SMOTE技术解决类别不平衡问题。

## Data

## 数据

A synthetic dataset named `synthetic_health_data.csv` will be provided (or generated by a script). This dataset simulates basic patient records and includes the following columns:\
将提供一个名为 `synthetic_health_data.csv` 的合成数据集（或通过脚本生成）。该数据集模拟了基本的病人记录，并包含以下列：

-   `patient_id`: Unique identifier for each patient.\
    `patient_id`：每位病人的唯一标识符。
-   `timestamp`: Timestamp of the measurement/record.\
    `timestamp`：测量/记录的时间戳。
-   `age`: Age of the patient (years).\
    `age`：病人的年龄（岁）。
-   `systolic_bp`: Systolic blood pressure (mmHg).\
    `systolic_bp`：收缩压（毫米汞柱）。
-   `diastolic_bp`: Diastolic blood pressure (mmHg).\
    `diastolic_bp`：舒张压（毫米汞柱）。
-   `glucose_level`: Blood glucose level (mg/dL).\
    `glucose_level`：血糖水平（毫克/分升）。
-   `bmi`: Body Mass Index.\
    `bmi`：身体质量指数。
-   `smoker_status`: Categorical variable ('yes', 'no', 'former').\
    `smoker_status`：类别变量（“yes”，"no"，"former"）。
-   `heart_rate`: Heart rate (bpm) - *Used in Part 2*.\
    `heart_rate`：心率（次/分钟）- *在第2部分使用*。
-   `disease_outcome`: Binary target variable (1 for disease present, 0 for no disease). This target is intentionally imbalanced.\
    `disease_outcome`：二元目标变量（1表示有疾病，0表示无疾病）。该目标变量有意设置为不平衡。

## Assignment Structure

## 作业结构

This assignment is divided into three parts, each corresponding to a Jupyter Notebook:\
本次作业分为三部分，每部分对应一个Jupyter Notebook：

1.  **`part1_introduction.ipynb`**: Focuses on loading data, basic exploration, training a Logistic Regression model, and evaluating its performance.\
    **`part1_introduction.ipynb`**：侧重于数据加载、基本探索、训练逻辑回归模型并评估其性能。
2.  **`part2_feature_engineering.ipynb`**: Explores basic time-series feature extraction (using `heart_rate`), training Random Forest and XGBoost models.\
    **`part2_feature_engineering.ipynb`**：探索基本的时间序列特征提取（使用`heart_rate`），训练随机森林和XGBoost模型。
3.  **`part3_data_preparation.ipynb`**: Deals with handling categorical features (One-Hot Encoding) and addressing class imbalance using SMOTE.\
    **`part3_data_preparation.ipynb`**：处理类别特征（独热编码）并使用SMOTE解决类别不平衡问题。

## Simplified Tasks

## 简化任务

### Part 0: Data Collection

### 第0部分：数据收集

1.  Run `generate_data.py` to generate the `synthetic_health_data.csv` dataset.
    1.  运行 `generate_data.py` 以生成 `synthetic_health_data.csv` 数据集。

### Part 1: Introduction to Classification & Evaluation (`part1_introduction.ipynb`)

### 第1部分：分类与评估简介（`part1_introduction.ipynb`）

1.  **Load Data:** Load the `synthetic_health_data.csv` file into a pandas DataFrame.\
    **加载数据：** 将 `synthetic_health_data.csv` 文件加载到pandas DataFrame中。
2.  **Prepare Data:** Select relevant features and the target. Split the data into training and testing sets. Handle any missing values.\
    **准备数据：** 选择相关特征和目标变量，将数据分为训练集和测试集，处理缺失值。
3.  **Train Model:** Train a Logistic Regression model on the training data.\
    **训练模型：** 在训练数据上训练逻辑回归模型。
4.  **Evaluate Model:** Calculate accuracy, precision, recall, F1 score, AUC, and confusion matrix.\
    **评估模型：** 计算准确率、精确率、召回率、F1分数、AUC和混淆矩阵。
5.  **Save Results:** Save the metrics to `results/results_part1.txt`.\
    **保存结果：** 将指标保存到 `results/results_part1.txt`。
6.  **Interpret Results:** Implement a function `interpret_results(metrics)` that analyzes the model performance on imbalanced data. The function should return a dictionary with keys 'best_metric', 'worst_metric', and 'imbalance_impact_score' (a custom score from 0-1 indicating how much the class imbalance affected results). Additionally, write your manual interpretation of these results in a file called `RESULTS.md`.\
    **结果解释：** 实现一个函数 `interpret_results(metrics)`，分析模型在不平衡数据上的表现。该函数应返回一个字典，包含'best_metric'、'worst_metric'和'imbalance_impact_score'（自定义分数，0-1，表示类别不平衡对结果的影响程度）。此外，将你的人工解释写入名为 `RESULTS.md` 的文件。

### Part 2: Time Series Features & Tree-Based Models (`part2_feature_engineering.ipynb`)

### 第2部分：时间序列特征与基于树的模型（`part2_feature_engineering.ipynb`）

1.  **Extract Features:** Calculate rolling mean and standard deviation for heart rate.\
    **提取特征：** 计算心率的滑动均值和标准差。
2.  **Prepare Data:** Select features including the new rolling features and the target. Split into train/test sets.\
    **准备数据：** 选择包括新滑动特征和目标变量在内的特征，分为训练集和测试集。
3.  **Train Models:** Train Random Forest and XGBoost models.\
    **训练模型：** 训练随机森林和XGBoost模型。
4.  **Compare Models:** Calculate and compare AUC scores for both models.\
    **比较模型：** 计算并比较两个模型的AUC分数。
5.  **Save Results:** Save the AUC scores to `results/results_part2.txt`.\
    **保存结果：** 将AUC分数保存到 `results/results_part2.txt`。

### Part 3: Practical Data Preparation (`part3_data_preparation.ipynb`)

### 第3部分：实用数据准备（`part3_data_preparation.ipynb`）

1.  **Encode Categorical Features:** Use One-Hot Encoding for the `smoker_status` column to transform the categorical variable into numerical features.\
    **编码类别特征：** 对 `smoker_status` 列使用独热编码，将类别变量转换为数值特征。
2.  **Prepare Data:** Select features (including the one-hot encoded ones) and the target. Split into train/test sets.\
    **准备数据：** 选择特征（包括独热编码的特征）和目标变量，分为训练集和测试集。
3.  **Apply SMOTE:** Oversample the minority class in the training data.\
    **应用SMOTE：** 对训练数据中的少数类进行过采样。
4.  **Retrain and Evaluate:** Train a Logistic Regression model on the balanced data and evaluate on the original test set.\
    **重新训练与评估：** 在平衡后的数据上训练逻辑回归模型，并在原始测试集上评估。
5.  **Save Results:** Save the evaluation metrics to `results/results_part3.txt`.\
    **保存结果：** 将评估指标保存到 `results/results_part3.txt`。
6.  **Compare Results:** Implement a function `compare_models(part1_metrics, part3_metrics)` that calculates the percentage improvement for each metric between the imbalanced model (Part 1) and the balanced model (Part 3). The function should return a dictionary with metric names as keys and improvement percentages as values. Additionally, write your manual comparison and analysis in the `RESULTS.md` file.\
    **比较结果：** 实现一个函数 `compare_models(part1_metrics, part3_metrics)`，计算不平衡模型（第1部分）和平衡模型（第3部分）之间每个指标的百分比提升。该函数应返回一个以指标名称为键、提升百分比为值的字典。此外，将你的人工比较和分析写入 `RESULTS.md` 文件。

## Submission

## 提交

Submit your completed notebooks, the `results/` directory containing your output files, and your `RESULTS.md` file with your manual interpretations and analysis.\
提交你完成的notebook、包含输出文件的 `results/` 目录，以及包含你人工解释和分析的 `RESULTS.md` 文件。